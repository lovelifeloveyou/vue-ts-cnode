(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25f9e9b2"],{"3a5c":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"panel"},[s("div",{staticClass:"header topic_header"},[s("span",{staticClass:"topic_full_title"},[t.topic.top?s("span",{staticClass:"put_top"},[t._v("置顶 ")]):t.topic.good?s("span",{staticClass:"put_good"},[t._v("精华 ")]):"share"===t.topic.tab?s("span",{staticClass:"topiclist-tab"},[t._v("分享 ")]):"ask"===t.topic.tab?s("span",{staticClass:"topiclist-tab"},[t._v("问答 ")]):"job"===t.topic.tab?s("span",{staticClass:"topiclist-tab"},[t._v("工作 ")]):"dev"===t.topic.tab?s("span",{staticClass:"topiclist-tab"},[t._v("测试 ")]):t._e(),t._v(" "+t._s(t.topic.title)+" ")]),s("div",{staticClass:"changes"},[s("span",[t._v(" 发布于 "+t._s(t._f("fromNow")(t.topic.create_at))+" ")]),s("span",[t._v(" 作者 "),s("router-link",{attrs:{to:"/user/"+(t.topic.author&&t.topic.author.loginname)}},[t._v(t._s(t.topic.author&&t.topic.author.loginname))])],1),s("span",[t._v(" "+t._s(t.topic.visit_count)+" 次浏览 ")]),s("span",[t._v(" 来自 "+t._s(t._f("tab")(t.topic.tab))+" ")]),t.topic.is_collect&&t.accessInfo.success?s("input",{staticClass:"span-common  pull-right collect_btn",attrs:{type:"submit",value:"取消收藏",action:"de_collect"},on:{click:t.decollect}}):t._e(),!t.topic.is_collect&&t.accessInfo.success?s("input",{staticClass:"span-common span-success pull-right collect_btn",attrs:{type:"submit",value:"收藏",action:"collect"},on:{click:t.collect}}):t._e()]),t.topic.author&&t.topic.author.loginname===t.accessInfo.loginname?s("div",{attrs:{id:"manage_topic"}},[s("router-link",{attrs:{to:"/create/"+t.id}},[s("i",{staticClass:"fa fa-lg fa-pencil-square-o",attrs:{title:"编辑"}})])],1):t._e()]),s("div",{staticClass:"inner topic"},[s("div",{staticClass:"topic_content"},[s("div",{domProps:{innerHTML:t._s(t.topic.content)}})])])]),s("div",{staticClass:"panel"},[s("div",{staticClass:"header"},[s("span",{staticClass:"col_fade"},[t._v(t._s(t.topic.replies&&t.topic.replies.length)+" 回复")])]),t._l(t.topic.replies,(function(e,a){return s("div",{key:a,class:["cell reply_area reply_item",{reply_highlight:e.is_uped}],attrs:{reply_id:e.id,reply_to_id:"",id:e.id}},[s("div",{staticClass:"author_content"},[s("router-link",{staticClass:"user_avatar",attrs:{to:"/user/"+e.author.loginname}},[s("img",{attrs:{src:e.author.avatar_url,alt:"",title:""}})]),s("div",{staticClass:"user_info"},[s("router-link",{staticClass:"dark reply_author",attrs:{to:"/user/"+e.author.loginname}},[t._v(t._s(e.author.loginname))]),s("a",{staticClass:"reply_time",attrs:{href:"#"+e.id}},[t._v(t._s(a+1)+"楼•"+t._s(t._f("fromNow")(e.create_at)))]),e.author.loginname===t.topic.author.loginname?s("span",{staticClass:"reply_by_author"},[t._v("作者")]):t._e()],1),s("div",{staticClass:"user_action"},[s("span",[s("i",{class:["fa up_btn fa-thumbs-o-up",{uped:e.is_uped}],attrs:{title:"喜欢"},on:{click:function(s){return t.ups(e.id)}}}),s("span",{staticClass:"up-count"},[t._v("  "+t._s(e.ups?e.ups.length:0)+" ")])]),t.accessInfo.success?s("span",[t._v("  "),s("i",{staticClass:"fa fa-reply reply2_btn",attrs:{title:"回复"},on:{click:function(s){return t.reply(e.id,e.author.loginname)}}})]):t._e()])],1),s("div",{staticClass:"reply_content from-i5ting"},[s("div",{domProps:{innerHTML:t._s(e.content)}})]),s("div",{staticClass:"clearfix"},[s("div",{staticClass:"reply2_area"},[t.replyId===e.id?s("div",{staticClass:"markdown_editor in_editor"},[s("div",{staticClass:"markdown_in_editor"},[s("mavon-editor",{attrs:{subfield:!1,placeholder:" "},model:{value:t.reply1,callback:function(e){t.reply1=e},expression:"reply1"}}),s("div",{staticClass:"editor_buttons"},[s("input",{staticClass:"span-primary submit_btn",attrs:{type:"button",value:"回复"},on:{click:t.replyCallback1}})])],1)]):t._e()])])])})),t.accessInfo.success?s("div",{staticClass:"panel"},[t._m(0),s("div",{staticClass:"inner reply"},[s("div",{staticClass:"markdown_editor in_editor"},[s("div",{staticClass:"markdown_in_editor"},[s("mavon-editor",{attrs:{subfield:!1,placeholder:" "},model:{value:t.reply2,callback:function(e){t.reply2=e},expression:"reply2"}}),s("div",{staticClass:"editor_buttons"},[s("input",{staticClass:"span-primary submit_btn",attrs:{type:"button",value:"回复"},on:{click:t.replyCallback2}})])],1)])])]):t._e()],2)])},c=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header"},[s("span",{staticClass:"col_fade"},[t._v("添加回复")])])}],i=s("1da1"),n=s("d4ec"),o=s("bee2"),r=s("262e"),l=s("2caf"),p=(s("96cf"),s("9ab4")),u=s("2b0e"),d=s("2fe1"),h=s("4999"),f=s("ee23"),_=s("1e60"),v=s("a3e1"),k=function(t){Object(r["a"])(s,t);var e=Object(l["a"])(s);function s(){var t;return Object(n["a"])(this,s),t=e.apply(this,arguments),t.id="",t.replyId="",t.reply1="",t.reply2="",t}return Object(o["a"])(s,[{key:"topic",get:function(){return this.$store.state.detail.topic}},{key:"accessInfo",get:function(){return this.$store.state.app.accessInfo}},{key:"created",value:function(){var t=this.$route.params.id;this.id=t;var e=this.$store.state.app.accesstoken;this.fetchTopic({id:t,accesstoken:e,mdrender:!0})}},{key:"fetchTopic",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("getTopic",e);case 2:s=this.$store.state.detail.topic,this.changeSider(!0,!0,s.author.loginname);case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"ups",value:function(t){var e=this,s=this.$store.state.app.accessInfo,a=this.$store.state.app.accesstoken;if(s.success){var c={reply_id:t,accesstoken:a};v["a"].ups(c).then((function(t){var s=e.$route.params.id;e.fetchTopic({id:s,accesstoken:a,mdrender:!0})}),(function(t){console.log(t)}))}else this.signIn()}},{key:"collect",value:function(){var t=this,e=this.$store.state.app,s=e.accessInfo,a=e.accesstoken,c=this.$route.params.id,i={topic_id:c,accesstoken:a};s.success?v["a"].collect(i).then((function(e){t.fetchTopic({id:c,accesstoken:a,mdrender:!0})}),(function(t){console.log(t)})):this.signIn()}},{key:"decollect",value:function(){var t=this,e=this.$route.params.id,s=this.$store.state.app,a=s.accessInfo,c=s.accesstoken,i={topic_id:e,accesstoken:c};a.success?v["a"].deCollect(i).then((function(s){t.fetchTopic({id:e,accesstoken:c,mdrender:!0})}),(function(t){console.log(t)})):this.signIn()}},{key:"signIn",value:function(){var t=this;f["a"].open({showInput:!0,inputPlaceholder:"请输入accesstoken",confirmButtonText:"登陆",confirmCallBack:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(s){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!==s&&s){e.next=4;break}_["a"].info("accesstoken不能为空！"),e.next=8;break;case 4:return e.next=6,t.$store.dispatch("accesstoken",{accesstoken:s});case 6:a=t.$store.state.app.accessInfo,a.success?(t.$store.dispatch("changeAccesstoken",{accesstoken:s}),f["a"].close(),_["a"].info("登录成功！"),window.localStorage.setItem("accesstoken",s)):_["a"].info("accesstoken不正确，请重新输入！");case 8:case"end":return e.stop()}}),e)})));function s(t){return e.apply(this,arguments)}return s}(),cancelCallBack:function(t){f["a"].close()}})}},{key:"changeSider",value:function(t,e,s){this.$store.dispatch("authorOrNot",{showInfo:t,isAuthor:e}),this.$store.dispatch("getInfo",{username:s})}},{key:"reply",value:function(t,e){this.replyId=""===this.replyId?t:"",this.reply1="@".concat(e," ")}},{key:"replyCallback1",value:function(){var t=this,e=this.$store.state.app.accesstoken,s={reply_id:this.replyId,accesstoken:e,content:this.reply1,topicId:this.id};v["a"].replies(s).then((function(s){s.success&&(t.fetchTopic({id:t.id,accesstoken:e,mdrender:!0}),t.reply1="",t.replyId="")}),(function(t){console.log(t)}))}},{key:"replyCallback2",value:function(){var t=this,e=this.$store.state.app.accesstoken,s={accesstoken:e,content:this.reply2,topicId:this.id,reply_id:void 0};v["a"].replies(s).then((function(s){s.success&&(t.fetchTopic({id:t.id,accesstoken:e,mdrender:!0}),t.reply2="")}),(function(t){console.log(t)}))}}]),s}(u["default"]);k=Object(p["a"])([Object(d["b"])({filters:{tab:function(t){var e="";switch(t){case"share":e="分享";break;case"ask":e="问答";break;case"job":e="工作";break;case"dev":e="测试";break;default:break}return e},fromNow:h["a"]}})],k);var m=k,y=m,b=s("2877"),C=Object(b["a"])(y,a,c,!1,null,null,null);e["default"]=C.exports},4999:function(t,e,s){"use strict";function a(t){var e,s=new Date,a=new Date(t),c=s.getTime()-a.getTime();return c/1e3<60?e="".concat(Math.round(c/1e3)," 秒前"):c/1e3>=60&&c/1e3<3600?e="".concat(Math.round(c/1e3/60)," 分钟前"):c/1e3>=3600&&c/1e3<86400?e="".concat(Math.round(c/1e3/60/60)," 小时前"):c/1e3>=86400&&c/1e3<2592e3?e="".concat(Math.round(c/1e3/60/60/24)," 天前"):c/1e3>=2592e3&&c/1e3<31536e3?e="".concat(Math.round(c/1e3/60/60/24/30)," 月前"):c/1e3>=31536e3&&(e="".concat(Math.round(c/1e3/60/60/24/365)," 年前")),e}s.d(e,"a",(function(){return a}))}}]);
//# sourceMappingURL=chunk-25f9e9b2.a05b847c.js.map